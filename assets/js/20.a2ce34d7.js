(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{97:function(t,e,a){"use strict";a.r(e);var s=a(2),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"creer-sa-station-meteo-partie-1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#creer-sa-station-meteo-partie-1"}},[t._v("#")]),t._v(" Cr√©er sa station m√©t√©o - partie 1")]),t._v(" "),a("p",[t._v("Je vous avais parl√© dans mon dernier article que je souhaitais me remettre √† la programmation Arduino ainsi qu'√† la programmation Python afin de tester des montages √©lectroniques.")]),t._v(" "),a("p",[t._v('C\'est ce que j\'ai fait pour cr√©er ma propre station m√©t√©o et je vais vous en parler dans cet article pour la partie "Programmation Arduino" et dans le prochain pour la partie "Programmation Python" qui sera plus sur de la programmation MicroPython.')]),t._v(" "),a("p",[t._v("Pourquoi r√©diger deux articles sur la cr√©ation d'une station m√©t√©o ? Lorsque j'ai achet√© mon kit √©lectronique, j'avais acc√®s √† un lien me permettant de r√©cup√©rer une archive avec des informations pour connecter les composants entre eux et faire le programme associ√©. Mais en parcourant la documentation fournie, je me suis rendue compte que ce n'√©tait pas si facile que √ßa √† faire et qu'il n'existait pas de version pour le faire en microPython, d'o√π l'id√©e de ces deux articles.")]),t._v(" "),a("h2",{attrs:{id:"materiel-necessaire"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#materiel-necessaire"}},[t._v("#")]),t._v(" Mat√©riel n√©cessaire")]),t._v(" "),a("p",[t._v("Pour faire ma station m√©t√©o, j'utilise les composants suivants :")]),t._v(" "),a("ul",[a("li",[t._v("une carte ESP8266-12E")]),t._v(" "),a("li",[t._v("un capteur de temp√©rature et d'humidit√© DHT11")]),t._v(" "),a("li",[t._v("un capteur de pression BMP180")]),t._v(" "),a("li",[t._v("un capteur de lumi√®re BH1750FVI")]),t._v(" "),a("li",[t._v("un √©cran I2C OLED")]),t._v(" "),a("li",[t._v("une breadboard et des fils dupont pour faire les connexions entre les diff√©rents √©l√©ments")])]),t._v(" "),a("p",[t._v("Voici la carte des connexions entre la carte ESP8266-12E et les diff√©rents capteurs :")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("ESP8266-12E")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("I2C OLED")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("BH1750FVI")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("BMP180")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("DHT11")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("GND")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("GND")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("GND")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("GND")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("GND")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("3.3V")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("VCC")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("VCC")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("VCC")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("VCC")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("D3")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("SDA")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("SDA")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("SDA")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("D4")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("SCL")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("SCL")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("SCL")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("D5")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}}),t._v(" "),a("td",{staticStyle:{"text-align":"center"}}),t._v(" "),a("td",{staticStyle:{"text-align":"center"}}),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("OUT")])])])]),t._v(" "),a("h2",{attrs:{id:"que-va-faire-ce-programme"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#que-va-faire-ce-programme"}},[t._v("#")]),t._v(" Que va faire ce programme ?")]),t._v(" "),a("p",[t._v("Sur l'√©cran, on va faire un affichage de type \"sliders\", c'est-√†-dire que l'√©cran va afficher 4 vues diff√©rentes qui vont se d√©rouler les unes √† la suite des autres :")]),t._v(" "),a("ul",[a("li",[t._v("la date et l'heure,")]),t._v(" "),a("li",[t._v("la m√©t√©o du jour,")]),t._v(" "),a("li",[t._v("la m√©t√©o √† 3 jours,")]),t._v(" "),a("li",[t._v("les donn√©es des capteurs : temp√©rature, humidit√©, pression et luminosit√©")])]),t._v(" "),a("p",[t._v("Pour la r√©cup√©ration des informations m√©t√©o, on utilise l'API d'"),a("a",{attrs:{href:"https://openweathermap.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("OpenWeatherMap"),a("OutboundLink")],1),t._v(". Pour cela, il faut se cr√©er un compte afin de se cr√©er une cl√© d'API que l'on pourra ensuite passer dans les appels que l'on fera dans l'application.")]),t._v(" "),a("p",[t._v("La plupart des exemples que j'ai trouv√© utilisaient aussi l'API de "),a("a",{attrs:{href:"https://thingspeak.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("ThingSpeak"),a("OutboundLink")],1),t._v(" mais je n'avais pas envie de pousser les donn√©es lues sur les capteurs vers le Web, je voulais juste les afficher sur l'√©cran - histoire de r√©fl√©chir au code pour afficher correctement les donn√©es sur l'√©cran.")]),t._v(" "),a("p",[t._v("J'ai cr√©√© un projet Github qui va contenir tous les fichiers que je vais utiliser dans cet article est le suivant: "),a("a",{attrs:{href:"https://github.com/Steffy29/weatherstation-demo",target:"_blank",rel:"noopener noreferrer"}},[t._v("weatherstation-demo"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"programmation-arduino"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#programmation-arduino"}},[t._v("#")]),t._v(" Programmation Arduino")]),t._v(" "),a("p",[t._v("Pour bien commencer, on va configurer Arduino avec tous les √©l√©ments dont on a besoin.")]),t._v(" "),a("h3",{attrs:{id:"arduino-ide"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#arduino-ide"}},[t._v("#")]),t._v(" Arduino IDE")]),t._v(" "),a("p",[t._v("L'IDE pour programmer les cartes Arduino et autres est disponible "),a("a",{attrs:{href:"https://www.arduino.cc/en/software",target:"_blank",rel:"noopener noreferrer"}},[t._v("ici"),a("OutboundLink")],1),t._v(". Il vous permettra de coder votre application et de la charger ensuite sur la carte ESP8266 pour tester votre programme apr√®s l'avoir compil√©.")]),t._v(" "),a("h3",{attrs:{id:"configurer-arduino-ide"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configurer-arduino-ide"}},[t._v("#")]),t._v(" Configurer Arduino IDE")]),t._v(" "),a("p",[t._v("On va tout d'abord ajouter la gestion des cartes ESP8266 √† Arduino IDE. Pour cela, vous allez dans "),a("code",[t._v("Fichier->Pr√©f√©rences")]),t._v(" et ajouter dans "),a("code",[t._v("URL de gestionnaire de cartes suppl√©mentaires")]),t._v(" le lien : "),a("a",{attrs:{href:"https://arduino.esp8266.com/stable/package_esp8266com_index.json",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://arduino.esp8266.com/stable/package_esp8266com_index.json"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("p"),a("div",{staticClass:"text-align-center"},[a("img",{attrs:{src:"/add_package_esp8266com.png",alt:"Ajout de la gestion des cartes ESP8266"}})]),a("p"),t._v(" "),a("p",[t._v("Une fois l'ajout fait, il suffit de fermer cet √©cran en cliquant sur "),a("code",[t._v("OK")]),t._v(". On va ensuite dans "),a("code",[t._v("Outils->Type de cartes->Gestionnaire de carte")]),t._v('. Dans la partie recherche, on saisit "esp8266" pour filtrer les r√©sultats et on installe la version "ESP8266 by ESP8266 Community" en cliquant sur le bouton '),a("code",[t._v("Installer")]),t._v(".")]),t._v(" "),a("p"),a("div",{staticClass:"text-align-center"},[a("img",{attrs:{src:"/cardboard_manager.png",alt:"Gestionnaire de carte - s√©lection ESP8266"}})]),a("p"),t._v(" "),a("p",[t._v("Quand l'installation est termin√©e, on peut fermer cet √©cran en cliquant sur le bouton "),a("code",[t._v("Fermer")]),t._v(".")]),t._v(" "),a("p",[t._v("Si on retourne dans le menu "),a("code",[t._v("Outils->Type de carte->ESP8266 Boards(2.7.4)")]),t._v(", on peut maintenant s√©lectionner la carte que l'on va utiliser dans notre montage "),a("code",[t._v("NodeMCU 1.0 (ESP-12E module)")]),t._v(".")]),t._v(" "),a("p",[t._v("On va maintenant choisir le port sur lequel la carte est connect√©e, en allant dans "),a("code",[t._v("Outils->Port")]),t._v(" et l√† on choisit le port o√π la carte est connect√©e (ne pas oublier de la brancher via le c√¢ble USB üòâ ).")]),t._v(" "),a("h3",{attrs:{id:"importer-le-projet-weatherstation-demo-a-arduino-ide"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#importer-le-projet-weatherstation-demo-a-arduino-ide"}},[t._v("#")]),t._v(" Importer le projet weatherstation-demo √† Arduino IDE")]),t._v(" "),a("p",[t._v("Apr√®s avoir clon√© le projet Github weatherstation-demo, on va dans "),a("code",[t._v("Fichier->Ouvrir")]),t._v(" pour charger le fichier "),a("code",[t._v("WeatherStationDemo.ino")]),t._v(" qui se trouve dans "),a("code",[t._v("weatherstation-demo/arduino/WeatherStationDemo")]),t._v(". Le fichier est charg√© dans l'IDE ainsi que les fichiers "),a("code",[t._v("WeatherStationFonts.h")]),t._v(" et "),a("code",[t._v("WeatherStationImage.h")]),t._v(" qui contiennent les d√©finitions des fonts et images utilis√©es dans l'affichage des informations sur l'√©cran OLED.")]),t._v(" "),a("p"),a("div",{staticClass:"text-align-center"},[a("img",{attrs:{src:"/load_weatherstation_demo.png",alt:"Chargement du fichier WeatherStationDemo"}})]),a("p"),t._v(" "),a("h3",{attrs:{id:"ajouter-des-librairies-a-arduino-ide"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ajouter-des-librairies-a-arduino-ide"}},[t._v("#")]),t._v(" Ajouter des librairies √† Arduino IDE")]),t._v(" "),a("p",[t._v("Pour ajouter une librairie, on va dans "),a("code",[t._v("Croquis->Inclure une biblioth√®que->Ajouter la biblioth√®que .ZIP...")]),t._v(".")]),t._v(" "),a("p"),a("div",{staticClass:"text-align-center"},[a("img",{attrs:{src:"/add_library_zip_file.png",alt:"Ajout d'une biblioth√®que"}})]),a("p"),t._v(" "),a("p",[t._v("On va ajouter les 3 fichiers suivants :")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("weatherstation-demo/arduino/libs/esp8266-weather-station-master.zip")])]),t._v(" "),a("li",[a("code",[t._v("weatherstation-demo/arduino/libs/json-streaming-parser-master.zip")])]),t._v(" "),a("li",[a("code",[t._v("weatherstation-demo/arduino/libs/esp8266-oled-ssd1306-master.zip")])])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("Attention")]),t._v(" "),a("p",[t._v("Lors des tests que j'ai effectu√© pour r√©diger cet article, j'ai quelques erreurs de compilation. Ces erreurs venaient du fait que la librairie "),a("code",[t._v("esp8266-weather-station-master")]),t._v(" n'√©tait pas install√©e dans sa derni√®re version (2.0.1) ce qui g√©n√©rait des erreurs de fichiers manquants ou en erreur.")]),t._v(" "),a("p"),a("div",{staticClass:"text-align-center"},[a("img",{attrs:{src:"/esp8266_weather_station_master_last_version.png",alt:"Conna√Ætre la version d'une librairie"}})]),a("p")]),t._v(" "),a("p",[t._v("On va aussi ajouter la librairie d'Adafruit Adafruit_BMP085. Pour cela, on va faire "),a("code",[t._v("Croquis->Inclure une biblioth√®que->G√©rer les biblioth√®ques")]),t._v('. Comme pour l\'ajout de nouvelles cartes, on va chercher les librairies correspondants au capteur "BMP085".')]),t._v(" "),a("p"),a("div",{staticClass:"text-align-center"},[a("img",{attrs:{src:"/add_adafruit_bmp085.png",alt:"Ajout de la librairie Adafruit_BMP085"}})]),a("p"),t._v(" "),a("p",[t._v('On clique sur le bouton "Installer" pour ajouter cette librairie √† notre projet. Il est possible qu\'un message de d√©pendances manquantes s\'affiche, pour √™tre s√ªr que tout se passe bien lors de la compilation, on clique sur "Install all" pour avoir aussi les d√©pendances. Lorsque l\'installation est termin√©e, on n\'a plus qu\'√† cliquer sur le bouton "Fermer" pour fermer cet √©cran.')]),t._v(" "),a("h3",{attrs:{id:"mise-a-jour-du-code"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mise-a-jour-du-code"}},[t._v("#")]),t._v(" Mise √† jour du code")]),t._v(" "),a("p",[t._v("Dans le fichier "),a("code",[t._v("WeatherStationDemo.ino")]),t._v(", il faut mettre √† jour les √©l√©ments de connexion au Wifi ainsi que la cl√© d'API pour OpenWeatherMap :")]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/***************************\n * WIFI Settings\n **************************/")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" WIFI_SSID "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"your_wifi_ssid"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" WIFI_PWD "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"your_wifi_pwd"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// OpenWeatherMap Settings")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Sign up here to get an API key:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// https://docs.thingpulse.com/how-tos/openweathermap-key/")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" boolean IS_METRIC "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nString OPEN_WEATHER_MAP_APP_ID "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"your_openweathermap_app_id"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nString OPEN_WEATHER_MAP_LOCATION "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"your_location"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"tester-le-programme"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tester-le-programme"}},[t._v("#")]),t._v(" Tester le programme")]),t._v(" "),a("p",[t._v("Pour tester si tout fonctionne bien, on va compiler et charger le programme sur la carte ESP8266. Tout d'abord, on va v√©rifier que le programme compile en cliquant sur le bouton \"V√©rifier\" dans l'IDE.")]),t._v(" "),a("p"),a("div",{staticClass:"text-align-center"},[a("img",{attrs:{src:"/compile_program.png",alt:"V√©rifier le programme"}})]),a("p"),t._v(" "),a("p",[t._v("Si la v√©rification est correcte (il n'y pas d'erreur), on va pouvoir le charger sur la carte en cliquant sur le bouton \"T√©l√©verser avec un programmateur\" dans l'IDE. Attention, cela peut prendre un peu de temps car il y a d'abord la compilation avant de charger le binaire sur la carte.")]),t._v(" "),a("p"),a("div",{staticClass:"text-align-center"},[a("img",{attrs:{src:"/upload_program.png",alt:"T√©l√©verser avec un programmateur"}})]),a("p"),t._v(" "),a("h2",{attrs:{id:"comprendre-le-code"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#comprendre-le-code"}},[t._v("#")]),t._v(" Comprendre le code")]),t._v(" "),a("p",[t._v("Un programme Arduino de base a 2 fonctions :")]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("loop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("Ce programme n'√©chappe pas √† la r√®gle mais avec en plus les d√©finitions de constantes et de variables qui vont √™tre utilis√©es tout au long du programme :")]),t._v(" "),a("ul",[a("li",[t._v("WIFI,")]),t._v(" "),a("li",[t._v("DHT11,")]),t._v(" "),a("li",[t._v("Atmosphere et capteur de lumi√®re,")]),t._v(" "),a("li",[t._v("I2C OLED,")]),t._v(" "),a("li",[t._v("intervalle de mise √† jour,")]),t._v(" "),a("li",[t._v("Time zone (TZ),")]),t._v(" "),a("li",[t._v("OpenWeatherMap,")]),t._v(" "),a("li",[t._v("OLED display UI")])]),t._v(" "),a("p",[t._v("Ensuite, on d√©clare les prototypes des fonctions qui seront utilis√©es dans le programme :")]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("drawProgress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("OLEDDisplay "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("display"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" percentage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" String label"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// affichage d'une barre de proggresion")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateData")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("OLEDDisplay "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("display"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// mise √† jour des donn√©es affich√©es sur l'√©cran")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("drawDateTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("OLEDDisplay "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("display"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" OLEDDisplayUiState"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" int16_t x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" int16_t y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// affichage de la date et heure")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("drawCurrentWeather")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("OLEDDisplay "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("display"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" OLEDDisplayUiState"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" int16_t x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" int16_t y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// affichage de la m√©t√©o du jour")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("drawForecast")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("OLEDDisplay "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("display"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" OLEDDisplayUiState"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" int16_t x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" int16_t y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// affichage de la m√©t√©o √† 3 jours")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("drawForecastDetails")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("OLEDDisplay "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("display"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" dayIndex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// affichage du d√©tail de la m√©t√©o")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("drawHeaderOverlay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("OLEDDisplay "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("display"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" OLEDDisplayUiState"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// affichage du bas de page de l'√©cran avec l'heure et la temp√©rature")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("drawTempIntern")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("OLEDDisplay "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("display"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" OLEDDisplayUiState"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" int16_t x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" int16_t y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// affichage des informations r√©cup√©r√©es via les capteurs")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setReadyForWeatherUpdate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// pour faire les mises √† jour des donn√©es")]),t._v("\n")])])]),a("p",[t._v("Les affichages changent r√©guli√®rement gr√¢ce au code suivant :")]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Add frames")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this array keeps function pointers to all frames")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// frames are the single views that slide from right to left")]),t._v("\nFrameCallback frames"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" drawDateTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" drawCurrentWeather"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" drawForecast"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" drawTempIntern "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" numberOfFrames "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nOverlayCallback overlays"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" drawHeaderOverlay "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" numberOfOverlays "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("Je ne vais pas d√©tailler toutes les fonctions du code, je vais juste faire un focus sur 2 fonctions que j'ai trouv√© int√©ressantes.")]),t._v(" "),a("h3",{attrs:{id:"fonctions-de-dessin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fonctions-de-dessin"}},[t._v("#")]),t._v(" Fonctions de dessin")]),t._v(" "),a("p",[t._v("Si on prend, par exemple, la fonction "),a("code",[t._v("drawCurrentWeather")]),t._v(" qui permet d'afficher la m√©t√©o du jour dont voici le code :")]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("drawCurrentWeather")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("OLEDDisplay "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("display"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" OLEDDisplayUiState"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" int16_t x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" int16_t y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  display"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setFont")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ArialMT_Plain_10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  display"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTextAlignment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TEXT_ALIGN_CENTER"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  display"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("drawString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("38")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" currentWeather"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("description"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  display"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setFont")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ArialMT_Plain_24"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  display"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTextAlignment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TEXT_ALIGN_LEFT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  String temp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("currentWeather"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("temp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("IS_METRIC "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"¬∞C"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"¬∞F"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  display"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("drawString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" temp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  display"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setFont")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Meteocons_Plain_36"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  display"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTextAlignment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TEXT_ALIGN_CENTER"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  display"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("drawString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" currentWeather"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("iconMeteoCon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("Dans cette fonction, on peut noter que l'on m√©lange √† la fois l'affichage "),a("code",[t._v("display->")]),t._v(" et la r√©cup√©ration de donn√©es "),a("code",[t._v("String temp =...")]),t._v(".\nL'affichage dans l'√©cran se fait en 2 temps, d'abord on s√©lectionne la font ou l'image que l'on va afficher ainsi que l'alignement du texte, et ensuite, on affiche "),a("code",[t._v("drawString")]),t._v(" le r√©sultat en donnant la position de d√©part sur l'√©cran (x et y) et la donn√©e √† afficher.")]),t._v(" "),a("h3",{attrs:{id:"fonctions-de-lecture-des-capteurs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fonctions-de-lecture-des-capteurs"}},[t._v("#")]),t._v(" Fonctions de lecture des capteurs")]),t._v(" "),a("p",[t._v("Si on prend, par exemple, la fonction "),a("code",[t._v("readAtmosphere")]),t._v(" qui permet de lire la pression atmosph√©rique du capteur BPM280 dont voici le code :")]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readAtmosphere")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  tempAtom "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" bmp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readPressure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  Serial"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Pressure = "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  Serial"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tempAtom"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  Serial"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('" Pascal"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("Dans cette fonction, on va lire la pression du capteur via l'utilisation de la librairie d'Adafruit que l'on a ajout√© au projet. L'avantage de cette librairie est que les donn√©es lues sont directement exploitable (elles ont en Pascal) et l'on n'a pas besoin de faire des calculs du genre :")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("float B = 1 / 5.25588;\nfloat calcAltitude(float p0, float p1, float t) {\n  float C = pow((p0 / p1), B) - 1.0;\n  return (C * (t + 273.15)) / 0.0065;\n}\n")])])]),a("p",[t._v("Merci "),a("a",{attrs:{href:"https://twitter.com/Kongduino",target:"_blank",rel:"noopener noreferrer"}},[t._v("@Kongduino"),a("OutboundLink")],1),t._v(" pour les explications et le code.")]),t._v(" "),a("h2",{attrs:{id:"conclusion"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#conclusion"}},[t._v("#")]),t._v(" Conclusion")]),t._v(" "),a("p",[t._v("Et voil√†, cette premi√®re partie est termin√©e m√™me si elle √©tait d√©j√† un peu longue. Dans la prochaine partie, je d√©crirai la version faite en MicroPython. En attendant, le code et les librairies sont disponibles sur mon Github "),a("a",{attrs:{href:"https://github.com/Steffy29/weatherstation-demo",target:"_blank",rel:"noopener noreferrer"}},[t._v("weatherstation-demo"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("p",[t._v("Have fun !")])])}),[],!1,null,null,null);e.default=n.exports}}]);